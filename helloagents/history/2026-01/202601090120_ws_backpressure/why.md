# why - WS 慢消费者背压保护

## 背景

在单机压测中复现到慢消费者问题：当部分客户端“不读/延迟读”（例如 30% 接收端每条消息延迟 5s 才读取）时，端到端延迟分位数出现爆炸，且网关进程内存出现明显上涨。

该问题会在高并发群发/广播/大量在线推送时放大：少量慢端即可拖累整体（延迟抖动、GC、OOM 风险），属于高性价比（高 ROI）应优先治理的稳定性问题。

## 目标

- 在不改协议、不引入新中间件的前提下，为 WS 写路径补齐“背压边界”：
  - 避免对已 unwritable 的连接继续写入导致出站缓冲无限堆积
  - 对持续 unwritable 的慢端做可控断开（可配置阈值）
  - 产生可观测事件，便于定位与量化

